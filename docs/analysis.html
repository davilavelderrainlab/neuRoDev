<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Analysis Tools | neuRoDev</title>
<meta name="author" content="Erik Bot &amp; Asia Zonca">
<meta name="description" content="3.1 Loading necessary libraries and data  3.1.1 Loading the right libraries # functions package library(neuRoDev) # extra packages library(ComplexHeatmap)  3.1.2 Loading the networks necessary...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 3 Analysis Tools | neuRoDev">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 Loading necessary libraries and data  3.1.1 Loading the right libraries # functions package library(neuRoDev) # extra packages library(ComplexHeatmap)  3.1.2 Loading the networks necessary...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Analysis Tools | neuRoDev">
<meta name="twitter:description" content="3.1 Loading necessary libraries and data  3.1.1 Loading the right libraries # functions package library(neuRoDev) # extra packages library(ComplexHeatmap)  3.1.2 Loading the networks necessary...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.33/datatables.js"></script><link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="libs/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">neuRoDev</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Summary</a></li>
<li><a class="" href="network.html"><span class="header-section-number">2</span> Network exploration</a></li>
<li><a class="active" href="analysis.html"><span class="header-section-number">3</span> Analysis Tools</a></li>
<li><a class="" href="mapping-bulk.html"><span class="header-section-number">4</span> Mapping Bulk data</a></li>
<li><a class="" href="mapping-sc.html"><span class="header-section-number">5</span> Mapping Single-cell data</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/davilavelderrainlab/neuRoDev/blob/main/book/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analysis" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Analysis Tools<a class="anchor" aria-label="anchor" href="#analysis"><i class="fas fa-link"></i></a>
</h1>
<div id="loading-necessary-libraries-and-data-1" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Loading necessary libraries and data<a class="anchor" aria-label="anchor" href="#loading-necessary-libraries-and-data-1"><i class="fas fa-link"></i></a>
</h2>
<div id="loading-the-right-libraries-1" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Loading the right libraries<a class="anchor" aria-label="anchor" href="#loading-the-right-libraries-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># functions package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">neuRoDev</span><span class="op">)</span></span>
<span><span class="co"># extra packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap">ComplexHeatmap</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div id="loading-the-networks-necessary-objects-1" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Loading the networks necessary objects<a class="anchor" aria-label="anchor" href="#loading-the-networks-necessary-objects-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corticogenesis_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/corticogenesis.sce.html">corticogenesis.sce</a></span><span class="op">(</span>directory <span class="op">=</span> <span class="st">'~/Downloads'</span><span class="op">)</span></span>
<span><span class="va">neurogenesis_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/neurogenesis.sce.html">neurogenesis.sce</a></span><span class="op">(</span>directory <span class="op">=</span> <span class="st">'~/Downloads'</span><span class="op">)</span></span>
<span><span class="va">gliogenesis_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/gliogenesis.sce.html">gliogenesis.sce</a></span><span class="op">(</span>directory <span class="op">=</span> <span class="st">'~/Downloads'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="etraces" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> eTraces<a class="anchor" aria-label="anchor" href="#etraces"><i class="fas fa-link"></i></a>
</h2>
<p>We developed an intuitive way to directly visualize a molecular phenotype score in each cluster of our reference networks, which we called <strong>eTrace</strong> (expression Trace). We provide here an <a href="analysis.html#interactive">interactive tool</a> to directly assess the (log-normalized) expression of input genes and gene sets, as well as the expression enrichment trends (more statistically robust).</p>
<p>The function used to visualize eTraces is <strong>plot_eTrace</strong>. The function requires few inputs, with the only mandatory one being the reference network (<code>net</code>):</p>
<ul>
<li>
<code>net</code>: the reference network to use.</li>
<li>
<code>genes</code>: a specific gene or set of genes from which to derive the score to plot. If more genes are given, the output will be an averaged score of those genes. It defaults to NULL, as the user can directly provide a score per cluster (see <code>score</code>). If no genes are given and a score matrix is selected, all genes in the score matrix will be considered.</li>
<li>
<code>score</code>: it can be a vector, with one value per cluster, or a matrix. If a matrix is given together with genes (see <code>genes</code>), only the values of the selected genes that are present in the matrix will be shown. It defaults to the log-normalized expression values contained in <code>net</code> under <code>logcounts</code>.</li>
<li>
<code>expression_enrichment</code>: it defines whether to compute expression enrichment of the given genes, a more statistically robust way of looking at the expression. If TRUE, the score that will be used will be the expression enrichment score, regardless on what is put in <code>score</code>. It defaults to FALSE.</li>
<li>other plotting and fine-tuning inputs, see <strong>?plot_eTrace</strong> for further information.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span>, </span>
<span>            genes <span class="op">=</span> <span class="st">'SST'</span>, </span>
<span>            main <span class="op">=</span> <span class="st">'SST - no enrichment'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig1"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig1-1.png" alt="Single gene eTrace in corticogenesis." width="90%"><p class="caption">
Figure 3.1: Single gene eTrace in corticogenesis.
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span>, </span>
<span>            genes <span class="op">=</span> <span class="st">'PAX6'</span>, </span>
<span>            expression_enrichment <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            main <span class="op">=</span> <span class="st">'PAX6 - enrichment'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig2"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig2-1.png" alt="Single gene expression enrichment eTrace in corticogenesis." width="90%"><p class="caption">
Figure 3.2: Single gene expression enrichment eTrace in corticogenesis.
</p>
</div>
<p>Moreover, it is possible to inspect not only single genes but also gene sets. Any gene set of interest can be inspected with this procedure, and here we illustrate with real cases on how to work with them.</p>
<p>For example, we can visualize the expression of preferentially expressed genes in the relevant subclasses. The objects are available for download here.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corticogenesis_pe_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/Downloads/corticogenesis_subclass_preferential_genes.rds"</span><span class="op">)</span></span>
<span><span class="va">neurogenesis_pe_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/Downloads/neurogenesis_subclass_preferential_genes.rds"</span><span class="op">)</span></span>
<span><span class="va">gliogenesis_pe_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/Downloads/gliogenesis_subclass_preferential_genes.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span>, </span>
<span>            genes <span class="op">=</span> <span class="va">corticogenesis_pe_genes</span><span class="op">$</span><span class="va">Oligo</span>, </span>
<span>            main <span class="op">=</span> <span class="st">'Oligodendrocyte preferentially expressed genes'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig3"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig3-1.png" alt="Gene set eTrace in corticogenesis." width="90%"><p class="caption">
Figure 3.3: Gene set eTrace in corticogenesis.
</p>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span>, </span>
<span>            genes <span class="op">=</span> <span class="va">corticogenesis_pe_genes</span><span class="op">$</span><span class="va">Opc</span>, </span>
<span>            expression_enrichment <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            main <span class="op">=</span> <span class="st">'OPC preferentially expressed genes'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig4"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig4-1.png" alt="Genes set expression enrichment eTrace in corticogenesis." width="90%"><p class="caption">
Figure 3.4: Genes set expression enrichment eTrace in corticogenesis.
</p>
</div>
<p>Any kind of score can be visualized with eTrace. To demonstrate this, we have already computed preferential expression of Gene Ontology Biological Processes (BP), Molecular Functions (MF), and Cellular Components (CC), which can be downloaded here.
Each object is a list containing preferential expression scores in one of the three reference networks in the three ontologies (BP, MF, CC). Each element of each list contains the activity (<code>activity</code>) derived from Gene Set Variation Analysis (one value per gene set in each cluster) and the preferential expression scores (<code>preferential</code>; one value per gene set in each subclass).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corticogenesis_preferential_GO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">'~/Downloads/corticogenesis_preferential_GO.rds'</span><span class="op">)</span></span>
<span><span class="va">neurogenesis_preferential_GO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">'~/Downloads/neurogenesis_preferential_GO.rds'</span><span class="op">)</span></span>
<span><span class="va">gliogenesis_preferential_GO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">'~/Downloads/gliogenesis_preferential_GO.rds'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span>, </span>
<span>            score <span class="op">=</span> <span class="va">corticogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">activity</span><span class="op">[</span><span class="st">"Glycogen Biosynthetic Process (GO:0005978)"</span>,<span class="op">]</span>, </span>
<span>            main <span class="op">=</span> <span class="st">'Glycogen Biosynthesis'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig5"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig5-1.png" alt="Gene set activity score eTrace in corticogenesis." width="90%"><p class="caption">
Figure 3.5: Gene set activity score eTrace in corticogenesis.
</p>
</div>
<p>The expression enrichment values can be obtained by using the function <strong>get_eTrace</strong>, which requires as input:
- the reference network (<code>net</code>),
- the genes to use (<code>genes</code>),
- number of random genes to use as a comparison (<code>nRand</code>; defaults to 100).</p>
<p>Additionally, it is possible to look at within-lineage specific patterns of expression by subsetting the networks. For example, here we show the expression patterns of genes inside the oligodendrogenesis- and astrogenesis-specific trajectories of differentiation:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">astro_sce</span> <span class="op">&lt;-</span> <span class="va">gliogenesis_sce</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span>, pattern<span class="op">=</span><span class="st">"OPC"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span>, pattern<span class="op">=</span><span class="st">"Oli"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#removes everything that is oligodendroglia-related</span></span>
<span></span>
<span><span class="va">oli_sce</span> <span class="op">&lt;-</span> <span class="va">gliogenesis_sce</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span>, pattern<span class="op">=</span><span class="st">"OPC"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span>, pattern<span class="op">=</span><span class="st">"Oli"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#keeps only oligodendroglia-related</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">astro_sce</span>,</span>
<span>            genes <span class="op">=</span> <span class="st">"SPARCL1"</span>,</span>
<span>            expression_enrichment <span class="op">=</span> <span class="cn">T</span>,</span>
<span>            main <span class="op">=</span> <span class="st">"SPARCL1 in astrogenesis"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eTrace.html">plot_eTrace</a></span><span class="op">(</span><span class="va">oli_sce</span>,</span>
<span>            genes <span class="op">=</span> <span class="st">"MAG"</span>,</span>
<span>            expression_enrichment <span class="op">=</span> <span class="cn">T</span>,</span>
<span>            main <span class="op">=</span> <span class="st">"MAG in oligodendrogenesis"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig6"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig6-1.png" alt="Single gene expression enrichment eTrace within astrogenesis." width="90%"><p class="caption">
Figure 3.6: Single gene expression enrichment eTrace within astrogenesis.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig7"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig7-1.png" alt="Single gene expression enrichment eTrace within oligodendrogenesis." width="90%"><p class="caption">
Figure 3.7: Single gene expression enrichment eTrace within oligodendrogenesis.
</p>
</div>
</div>
<div id="interactive" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Interactive eTrace<a class="anchor" aria-label="anchor" href="#interactive"><i class="fas fa-link"></i></a>
</h2>
<p>To explore the normalized expression and expression enrichment levels of (single) genes it is possible to use this interactive tool and observe in a glance patterns over ~70 years of life.
Below you can access with one click to the three different resource levels and input a single gene or a gene set and look their patterns of expression in time and through subclasses.</p>
<p><a href="https://erikbot.shinyapps.io/etraceshinycortico/" target="_blank">
üîç Click here to interactively visualize the corticogenesis eTrace
</a></p>
<p><a href="https://erikbot.shinyapps.io/etraceshinyneuro/" target="_blank">
üîç Click here to interactively visualize the neurogenesis eTrace
</a></p>
<p><a href="https://erikbot.shinyapps.io/etraceshinyglio/" target="_blank">
üîç Click here to interactively visualize the gliogenesis eTrace
</a></p>
</div>
<div id="expression-enrichment-across-stage-and-subclass" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Expression enrichment across stage and subclass<a class="anchor" aria-label="anchor" href="#expression-enrichment-across-stage-and-subclass"><i class="fas fa-link"></i></a>
</h2>
<p>An alternative and compact visualization of expression enrichment in both subclasses and stages can be obtained with using the function <strong>plot_eMatrix</strong>. The inputs are listed below, and are the same as those needed by the <strong>get_eTrace</strong> function:</p>
<ul>
<li>
<code>net</code>: the reference network to use.</li>
<li>
<code>genes</code>: a specific gene or set of genes from which to derive the expression enrichment.</li>
<li>
<code>nRand</code>: the number of random sets to use for the expression enrichment calculation. Defaults to 100.</li>
</ul>
<p>This returns an <strong>eMatrix</strong> showing on the columns subclasses, on the rows stages, and the values represent enrichment score.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eMatrix.html">plot_eMatrix</a></span><span class="op">(</span>net <span class="op">=</span> <span class="va">corticogenesis_sce</span>, </span>
<span>             genes <span class="op">=</span> <span class="st">'VIP'</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-fig8"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig8-1.png" alt="VIP eMatrix in corticogenesis." width="441.6"><p class="caption">
Figure 3.8: VIP eMatrix in corticogenesis.
</p>
</div>
<details><summary><strong>Show the code (plotting eMatrix)</strong>
</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eMatrix.html">plot_eMatrix</a></span><span class="op">(</span>net <span class="op">=</span> <span class="va">neurogenesis_sce</span>, </span>
<span>             genes <span class="op">=</span> <span class="st">'NEUROD6'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eMatrix.html">plot_eMatrix</a></span><span class="op">(</span>net <span class="op">=</span> <span class="va">gliogenesis_sce</span>, </span>
<span>             genes <span class="op">=</span> <span class="st">'GFAP'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plot_eMatrix.html">plot_eMatrix</a></span><span class="op">(</span>net <span class="op">=</span> <span class="va">corticogenesis_sce</span>, </span>
<span>             genes <span class="op">=</span> <span class="va">corticogenesis_pe_genes</span><span class="op">$</span><span class="va">L6NIT</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-fig9"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig9-1.png" alt="NEUROD6 eMatrix in neurogenesis." width="528"><p class="caption">
Figure 3.9: NEUROD6 eMatrix in neurogenesis.
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-fig10"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig10-1.png" alt="GFAP eMatrix in gliogenesis." width="432"><p class="caption">
Figure 3.10: GFAP eMatrix in gliogenesis.
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-fig11"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig11-1.png" alt="L6NIT preferentially expressed genes eMatrix in corticogenesis." width="528"><p class="caption">
Figure 3.11: L6NIT preferentially expressed genes eMatrix in corticogenesis.
</p>
</div>
<p>It is possible to obtain the <code>eMatrix</code> itself by using the function <strong>get_eMatrix</strong>, which uses the same inputs as <strong>plot_eMatrix</strong>.</p>
</div>
<div id="visualization-of-enrichment-in-the-network" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Visualization of enrichment in the network<a class="anchor" aria-label="anchor" href="#visualization-of-enrichment-in-the-network"><i class="fas fa-link"></i></a>
</h2>
<p>As described in <a href="network.html#network">Chapter Network exploration</a>, we can visualize cluster-wise scores directly in the UMAP at the network level. This can be done with the <strong>plotNetworkScore</strong> function, setting <code>expression_enrichment</code> to TRUE.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/neuRoDev/man/plotNetworkScore.html">plotNetworkScore</a></span><span class="op">(</span>net <span class="op">=</span> <span class="va">corticogenesis_sce</span>, </span>
<span>                 genes <span class="op">=</span> <span class="va">corticogenesis_pe_genes</span><span class="op">$</span><span class="va">Oligo</span>, </span>
<span>                 expression_enrichment <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 main <span class="op">=</span> <span class="st">"Enrichment: Oli preferential genes"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-fig12"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig12-1.png" alt="Gene expression enrichment in the corticogenesis network." width="672"><p class="caption">
Figure 3.12: Gene expression enrichment in the corticogenesis network.
</p>
</div>
</div>
<div id="preferential-expression" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Preferential expression<a class="anchor" aria-label="anchor" href="#preferential-expression"><i class="fas fa-link"></i></a>
</h2>
<p>We can inspect the preferential expression scores of preferentially expressed genes in the networks.</p>
<details><summary><strong>Show the code (plotting heatmaps)</strong>
</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_genes_cortico</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">i</span>, decreasing <span class="op">=</span>  <span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h_cortico</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">top_genes_cortico</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="st">'preferential\nexpression'</span>, </span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>  width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">top_genes_cortico</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>,</span>
<span>  rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">h_cortico</span>, , heatmap_legend_side <span class="op">=</span> <span class="st">'left'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_genes_neuro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">neurogenesis_sce</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">neurogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">i</span>, decreasing <span class="op">=</span>  <span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h_neuro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">neurogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">top_genes_neuro</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">neurogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="st">'preferential expression'</span>, </span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">neurogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>  width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">top_genes_neuro</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>  rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">h_neuro</span>, , heatmap_legend_side <span class="op">=</span> <span class="st">'left'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_genes_glio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">i</span>, decreasing <span class="op">=</span>  <span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h_glio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">top_genes_glio</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="st">'preferential expression'</span>, </span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">@</span><span class="va">metadata</span><span class="op">$</span><span class="va">subclass_psb</span><span class="op">)</span><span class="op">[[</span><span class="st">'preferential'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">top_genes_glio</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>  rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">h_glio</span>, , heatmap_legend_side <span class="op">=</span> <span class="st">'left'</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:ch3-fig13"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig13-1.png" alt="Top preferential genes in corticogenesis." width="92%"><p class="caption">
Figure 3.13: Top preferential genes in corticogenesis.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig14"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig14-1.png" alt="Top preferential genes in neurogenesis." width="92%"><p class="caption">
Figure 3.14: Top preferential genes in neurogenesis.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig15"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig15-1.png" alt="Top preferential genes in gliogenesis." width="95%"><p class="caption">
Figure 3.15: Top preferential genes in gliogenesis.
</p>
</div>
We can also visualize the preferential expression scores of gene ontology biological processes.
<details><summary><strong>Show the code (plotting heatmaps)</strong>
</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_GO_bp_cortico_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">corticogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">corticogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">i</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span> <span class="co">#selecting top 2 processes by subclass</span></span>
<span></span>
<span><span class="va">top_GO_bp_cortico</span> <span class="op">&lt;-</span> <span class="va">corticogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">top_GO_bp_cortico_list</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">top_GO_bp_cortico</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"\\s*\\(GO:\\d+\\)$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">top_GO_bp_cortico</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">top_GO_bp_cortico</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">corticogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span><span class="op">)</span><span class="op">]</span>, </span>
<span>             name <span class="op">=</span> <span class="st">'preferential\nexpression'</span>, </span>
<span>             width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">top_GO_bp_cortico</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>             height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">top_GO_bp_cortico</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>             cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>             rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">h</span>, heatmap_legend_side <span class="op">=</span> <span class="st">'left'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_GO_bp_neuro_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">neurogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">neurogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">i</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_GO_bp_neuro</span> <span class="op">&lt;-</span> <span class="va">neurogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">top_GO_bp_neuro_list</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">top_GO_bp_neuro</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"\\s*\\(GO:\\d+\\)$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">top_GO_bp_neuro</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h_neuro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">top_GO_bp_neuro</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">neurogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                   name <span class="op">=</span> <span class="st">'preferential\nexpression'</span>, </span>
<span>                   width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">top_GO_bp_neuro</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>                   height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">top_GO_bp_neuro</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>                   cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                   rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">h_neuro</span>, heatmap_legend_side <span class="op">=</span> <span class="st">'left'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_GO_bp_glio_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">gliogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gliogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">i</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_GO_bp_glio</span> <span class="op">&lt;-</span> <span class="va">gliogenesis_preferential_GO</span><span class="op">$</span><span class="va">GO_Biological_Process_2025</span><span class="op">$</span><span class="va">preferential</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">top_GO_bp_glio_list</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">top_GO_bp_glio</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"\\s*\\(GO:\\d+\\)$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">top_GO_bp_glio</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h_glio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">top_GO_bp_glio</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">gliogenesis_sce</span><span class="op">$</span><span class="va">SubClass</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  name <span class="op">=</span> <span class="st">'preferential\nexpression'</span>, </span>
<span>                  width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">top_GO_bp_glio</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>                  height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">top_GO_bp_glio</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>, </span>
<span>                  cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                  rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">h_glio</span>, heatmap_legend_side <span class="op">=</span> <span class="st">'left'</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:ch3-fig16"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig16-1.png" alt="Top gene ontology biological processes in corticogenesis." width="90%"><p class="caption">
Figure 3.16: Top gene ontology biological processes in corticogenesis.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig17"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig17-1.png" alt="Top gene ontology biological processes in neurogenesis." width="90%"><p class="caption">
Figure 3.17: Top gene ontology biological processes in neurogenesis.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:ch3-fig18"></span>
<img src="libs/3-Analysis_Tools_files/figure-html/ch3-fig18-1.png" alt="Top gene ontology biological processes in gliogenesis." width="90%"><p class="caption">
Figure 3.18: Top gene ontology biological processes in gliogenesis.
</p>
</div>
<p>To focus on corticogenesis-related processes we have also manually curated a list of Gene Ontology Biological Processes for the corticogenesis and neurogenesis networks, available for download here.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="network.html"><span class="header-section-number">2</span> Network exploration</a></div>
<div class="next"><a href="mapping-bulk.html"><span class="header-section-number">4</span> Mapping Bulk data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analysis"><span class="header-section-number">3</span> Analysis Tools</a></li>
<li>
<a class="nav-link" href="#loading-necessary-libraries-and-data-1"><span class="header-section-number">3.1</span> Loading necessary libraries and data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#loading-the-right-libraries-1"><span class="header-section-number">3.1.1</span> Loading the right libraries</a></li>
<li><a class="nav-link" href="#loading-the-networks-necessary-objects-1"><span class="header-section-number">3.1.2</span> Loading the networks necessary objects</a></li>
</ul>
</li>
<li><a class="nav-link" href="#etraces"><span class="header-section-number">3.2</span> eTraces</a></li>
<li><a class="nav-link" href="#interactive"><span class="header-section-number">3.3</span> Interactive eTrace</a></li>
<li><a class="nav-link" href="#expression-enrichment-across-stage-and-subclass"><span class="header-section-number">3.4</span> Expression enrichment across stage and subclass</a></li>
<li><a class="nav-link" href="#visualization-of-enrichment-in-the-network"><span class="header-section-number">3.5</span> Visualization of enrichment in the network</a></li>
<li><a class="nav-link" href="#preferential-expression"><span class="header-section-number">3.6</span> Preferential expression</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/davilavelderrainlab/neuRoDev/blob/main/book//blob/master/3-Analysis_Tools.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/davilavelderrainlab/neuRoDev/blob/main/book//edit/master/3-Analysis_Tools.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>neuRoDev</strong>" was written by Erik Bot &amp; Asia Zonca. It was last built on 2025-12-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
